### nnCron

В состав Windows входит штатный Планировщик задач, но, к сожалению, он работает не всегда бесперебойно. Например, время от времени он куда-то расходует так называемую [Desktop Heap](https://docs.microsoft.com/en-us/archive/blogs/ntdebugging/desktop-heap-overview), после чего просто прекращает запускать новые экземпляры заданий. Лечится это регулярной перезагрузкой, но, согласитесь, сервер — это такой компьютер, который хотелось бы перезагружать пореже.

Но не будем отчаиваться! Мы можем воспользоваться, например, [nnCron Lite](http://www.nncron.ru/index_ru.shtml) — совершенно бесплатной утилитой, которая умеет запускать приложения по расписанию. Вот как его характеризуют авторы:

nnCron LITE — это крошечный, но, вместе с тем, полнофункциональный планировщик. С его помощью можно в указанное время и с заданной периодичностью запускать любые процессы. nnCron LITE вобрал в себя все лучшее из известного в мире UNIX планировщика cron (включая функциональность программы anacron). Основные достоинства nnCron LITE:

* может быть запущен в качестве службы (сервиса) или как обычное приложение;
* понимает cron-формат (Unix) и управляется с помощью текстовых crontab-файлов, формат которых совместим с форматом crontab-файлов Unix-систем;
* умеет отслеживать и перезапускать просроченные задачи;
* умеет задавать и использовать переменные окружения (environment variables);
* умеет запускать процессы от имени текущего авторизованного пользователя (WinNT/2000/XP);
* позволяет запускать плагины (скрипты произвольной сложности), написанные на языке программирования Форт;
* гибко настраивается под конкретные нужды пользователя;
* не требователен к ресурсам компьютера. Он будет работать даже на очень слабых машинах, не оказывая отрицательного влияния на производительность. Нам никогда не приходилось видеть, чтобы сервис nnCron LITE занял в оперативной памяти больше 150k;
* nnCron LITE это «младший брат» мощнейшего планировщика/скриптера/менеджера автоматизации nnCron.

`cron.tab` выглядит примерно так:

```
#CRONTAB FILE
# Classic crontab format:
# Minutes Hours Days Months WeekDays Command

*/15 8-16 * * 1-5 checkmail.exe
```

Единственное задание здесь расшифровывается так: «каждые 15 минут в промежутке между 8:00 и 16:00 с понедельника по пятницу запускать checkmail.exe«. Для тех, кому трудно заполнять crontab вручную, есть отличный сайт http://corntab.com.

nnCron раз в минуту проверяет дату последней модификации `cron.tab` и, обнаружив обновление информации, автоматически перечитывает его. Если же вы внесли изменения в `cron.tab` и не хотите ждать, пока nnCron автоматически перечитает его, вы можете «форсировать» перечитывание `cron.tab`, набрав в командной строке

```shell
cron.exe -reload
```

Комментарии в `cron.tab` начинаются с символа `'#'` и продолжаются до конца строки. В `cron.tab` допускается произвольное количество пустых строк (пустые строки не учитываются парсером при перечитывании `cron.tab`). Лидирующие пробелы и знаки табуляции тоже игнорируются.

Основные настройки в `cron.ini`

#### AsLoggedUser ON/OFF

Позволяет запускать все приложения от имени залогинившегося пользователя.

#### Cronlog: filename

Задает имя лог-файла nnCron LITE.

#### DefaultOpenMode: mode

Задает режим по умолчанию, в котором nnCron LITE будет запускать приложения (окно приложения отображается в обычном режиме, свернутым в значок, распахнутым на весь экран или скрытым). Допустимые значения: `ShowNormal`, `ShowMinimized`, `ShowMaximized`, `SWHide`.

#### DefaultPriority: priority

Задает приоритет по умолчанию, с которым nnCron LITE будет запускать приложения. Допустимые значения: `HighPriority`, `IdlePriority`, `NormalPriority`, `RealtimePriority`.

#### INCLUDE «filename»

«Подключает» плагины (скрипты), написанные на языке Форт. После того, как плагин подключен с помощью `INCLUDE`, его можно запускать прямо из nnCron LITE. В `cron.ini` можно использовать несколько слов `INCLUDE` — по числу подключенных плагинов.
